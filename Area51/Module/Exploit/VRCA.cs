using System;
using System.Net;
using System.Threading.Tasks;
using Area51.SDK;

namespace Area51.Module.Exploit
{
	internal class VRCA : BaseModule
	{
		public VRCA()
			: base("Download VRCA", "Downloads Current VRCA", Main.Instance.Avatarexploitbutton, ButtonIcons.DownloadIcon)
		{
		}

		public override void OnEnable()
		{
			Task.Run(delegate
			{
				WebClient webClient = new WebClient
				{
					Headers = { "User-Agent: Other" }
				};
				webClient.DownloadFileAsync(new Uri(VRCPlayer.field_Internal_Static_VRCPlayer_0.prop_ApiAvatar_0.assetUrl), "Area51/VRCA/" + VRCPlayer.field_Internal_Static_VRCPlayer_0.prop_ApiAvatar_0.name + "_" + VRCPlayer.field_Internal_Static_VRCPlayer_0.prop_ApiAvatar_0.id + ".vrca");
				LogHandler.Log(LogHandler.Colors.Green, "Downloaded VRCA Completed");
			});
		}
	}
}
