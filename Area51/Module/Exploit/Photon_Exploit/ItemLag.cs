using System.Collections;
using Area51.SDK;
using MelonLoader;
using UnityEngine;
using VRC.SDKBase;

namespace Area51.Module.Exploit.Photon_Exploit
{
	internal class ItemLag : BaseModule
	{
		public ItemLag()
			: base("Item Lag", "Lags Server Via Spamming Items Location, Owner, ", Main.Instance.Eventexploitbutton, null, isToggle: true)
		{
		}

		public override void OnEnable()
		{
			MelonCoroutines.Start(ItemLagger());
			MelonCoroutines.Start(ItemLagger2());
			LogHandler.LogDebug("Started Item Laggger!");
		}

		public override void OnDisable()
		{
			LogHandler.LogDebug("Stopped Item Laggger!");
		}

		public IEnumerator ItemLagger()
		{
			while (toggled)
			{
				foreach (VRC_Pickup item in Object.FindObjectsOfType<VRC_Pickup>())
				{
					Networking.LocalPlayer.TakeOwnership(item.gameObject);
					item.transform.position = PlayerWrapper.LocalPlayer.transform.position + new Vector3(0f, 0.15f, 0f);
				}
				yield return new WaitForSeconds(0.3f);
			}
		}

		public IEnumerator ItemLagger2()
		{
			while (toggled)
			{
				foreach (VRC_Pickup item in Object.FindObjectsOfType<VRC_Pickup>())
				{
					Networking.LocalPlayer.TakeOwnership(item.gameObject);
					item.transform.position = PlayerWrapper.LocalPlayer.transform.position + new Vector3(0f, 9.998E+07f, 0f);
				}
				yield return new WaitForSeconds(0.3f);
			}
		}
	}
}
