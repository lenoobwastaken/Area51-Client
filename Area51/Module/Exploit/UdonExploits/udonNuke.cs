using System.Collections;
using Area51.SDK;
using Il2CppSystem.Collections.Generic;
using MelonLoader;
using UnityEngine;
using VRC.Udon;
using VRC.Udon.Common.Interfaces;

namespace Area51.Module.Exploit.UdonExploits
{
	internal class udonNuke : BaseModule
	{
		public udonNuke()
			: base("Udon Nuke", "Spams Udon A Lot Of Udon Shit.", Main.Instance.Eventexploitbutton, null, isToggle: true)
		{
		}

		public override void OnEnable()
		{
			MelonCoroutines.Start(UdonKill());
		}

		private IEnumerator UdonKill()
		{
			while (toggled)
			{
				for (int f = 0; f < WorldWrapper.udonBehaviours.Length; f++)
				{
					foreach (UdonBehaviour item in Object.FindObjectsOfType<UdonBehaviour>())
					{
						Dictionary<string, List<uint>>.Enumerator enumerator2 = item._eventTable.GetEnumerator();
						while (enumerator2.MoveNext())
						{
							KeyValuePair<string, List<uint>> current2 = enumerator2.current;
							item.SendCustomNetworkEvent(NetworkEventTarget.All, current2.Key);
						}
					}
					yield return new WaitForSeconds(0.1f);
					if (!toggled)
					{
						break;
					}
				}
				yield return new WaitForSeconds(0.1f);
			}
		}
	}
	internal class UdonNuke : BaseModule
	{
		public UdonNuke()
			: base("Udon Nuker", "Spams Udon A Lot Of UdonShit", Main.Instance.udonexploitbutton, null, isToggle: true)
		{
		}

		public override void OnEnable()
		{
			MelonCoroutines.Start(UdonKill());
		}

		public IEnumerator UdonKill()
		{
			while (toggled)
			{
				for (int f = 0; f < WorldWrapper.udonBehaviours.Length; f++)
				{
					foreach (UdonBehaviour item in Object.FindObjectsOfType<UdonBehaviour>())
					{
						Dictionary<string, List<uint>>.Enumerator enumerator2 = item._eventTable.GetEnumerator();
						while (enumerator2.MoveNext())
						{
							KeyValuePair<string, List<uint>> current2 = enumerator2.current;
							item.SendCustomNetworkEvent(NetworkEventTarget.All, current2.Key);
						}
					}
					yield return new WaitForSeconds(0.1f);
					if (!toggled)
					{
						break;
					}
				}
				yield return new WaitForSeconds(0.1f);
			}
		}
	}
}
